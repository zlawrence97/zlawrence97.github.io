<html>
<title>Comuter Vision</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<head>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin|Arvo|Source+Serif+Pro">
  <link rel="stylesheet" href="styles.css">
  <style>
    body{
      font-family:Cabin;
    }
    
    .column {
      float: left;
      width: 23.33%;
      padding: 5px;
    }

    .row::after {
      content: "";
      clear: both;
      display: flex;
    }
    
  </style> 
</head>

<body>
  <header class="header" style="padding: 1em; clear: left; text-align:center; background-color:black; color:white;">
    <h1 class="title">Project 4 - Image Tracking using Tensorflow</h1>
    <h3 class="naem">by: Paul Azzy, John Shepherd and Zuri Lawrence</h3>
  </header>
  <div class="project">
    <article class="full-explanation">
      <div class="content">
        <article class="write-up">
          <div class="inner">
            <aside class="explanation" style="margin-right: 770px; border-left: 200px; padding: 1em;">
              <div class="intro">
		        <h2 class="desc">Introduction</h2>
		        <p>Given that the current state of computer vision as it applies to sports is an ongoing research topic, 
		        we became interested in this project and decided to pursue it (Thomas, G., et al., Computer Vision for 
		        Sports: Current Applications and Research Topics, 2017).  Sports analytics is a huge area driven by data. 
		        Archetyping a system to output the desired data for a given sports scenario would be invaluable to every 
		        institution that utilizes sports statistics.<br>
		        So, the objective of this project was to train an object detection model to track players, balls, and 
		        referees in sport videos. We decided to start with these classes as they are the fundamental elements to a 
		        sports game.  We wanted to train across multiple sports to attempt to create a system that could be universally 
		        applied to any sport that one wishes to collect data on; so, as a basis, we trained our model to recognize 
		        basketball, baseball, soccer, and tennis videos. Depending on which video is used, the model is able to tell 
		        which sport the athletes in the scene are playing, as well as the kind of sport ball that is being used.<br> 
				While being able to track people and objects in a scene may seem trivial at first, the implications of having 
				such tracking have endless applications. For example, in this sports recognition scenario, we could hypothetically 
				train an object detection model to recognize players on opposing teams and create predictive models over the 
				course of multiple games played against each other to determine the plays each team is likely to use. Further, 
				we could potentially output more concrete statistics such as how close a baseball player was to hitting the ball 
				or outputting why someone’s shot may be off in basketball.<br>
				Tensorflow is currently an extremely popular library in the machine learning field so we decided to go this route.
				Tensorflow uses deep learning to train on large amounts of data.  This library was perfect for our purposes.  
				In his tutorial at https://towardsdatascience.com/how-to-train-your-own-object-detector-with-tensorflows-object-detector-api-bec72ecfe1d9, 
				Dat Tran creates a raccoon classifier with Tensorflow.  We took this tutorial as a motivation to make our own 
				player/ball classifier.<br>
		        </p>
	          </div>
	          <div class="related-work">
	            <h2 class="title">Related Work</h2>
	            <p>Computer Vision within sports is a hot topic and many publications have been released in just the past year 
	            concerning player and ball tracking.  Earlier takes on the topic around 2000 focus on specific camera calibration 
	            and lens distortion correction to detect players and balls (J. Pers, Computer Vision System for Tracking Players 
	            in Sports Games, 2000).  This hardware solution is not too realistic in the end as a whole system must be 
	            calibrated for each specific instance that one wishes to observe.  Recent research results to software solutions 
	            specifically using machine learning to detect players and balls.  Graham Thomas et al. discuss current vision-based
	            systems, the impact on various sports, and open issues of fully automated player/ball tracking (Computer Vision 
	            for Sports: Current Applications and Research Topics, 2017).  According to his team, fully automated sports/ball 
	            tracking is an ongoing problem that is still being solved.  This problem motivated are team to archetype a potential
	            solution using the latest methods of deep learning and neural networks.<br>
	            </p>
	          </div>
	          <div class="approach">
	            <h2 class="title">Our Approach"</h2>
	              <h3>Data Handling</h3>
	              <p>As previously mentioned, TensorFlow was used for our machine learning purposes. While the installation of the 
	              library was fairly simple, the steps required to train the object detection model were fairly convoluted. The 
	              first step we made towards making our model was scraping, downloading, and labeling images from Google Images 
	              and sports highlight videos. Together, we gathered and labeled nearly 500 images from all four sports we wanted 
	              to detect players, balls, and referees from. The labels for all the images were saved in .xml files that were 
	              then converted to a single .csv file. This .csv file was then split up into testing and training .csv files. 10% 
	              of the dataset was used for training, and 10% of the dataset was used for testing. The reason for this split is 
	              so that we don’t test on the same data that we trained on. That would be counterproductive to ensuring that the 
	              model we created is actually applicable in a real world setting. These .csv files were then converted into 
	              .record files which is the data set format that Tensorflow accepts for image analysis.<br>
	              </p>
	              <div class="data-gathered">
                    <div class="column">
	      			  <img class="hybrid img responsive pull-left" src="../images/cv4/data-traning1.png" alt="depth-matched" style="width: 378px; height: 324px; margin-bottom: .5em"> 
	    			</div>
	    			<div class="column">
	      			  <img class="hybrid img responsive pull-left" src="../images/cv4/data-traning2.png" alt="orig-stereo" style="width: 378px; height: 324px; margin-bottom: .5em">
        			</div>
        			<div class="column">
          			  <img class="hybrid img responsive pull-left" src="../images/cv4/data-training3.png" alt="orig-depth" style="width: 378px; height: 324px; margin-bottom: .5em">
        		    </div>
        		    <div class="column">
        		      <img class="hybrid img responsive pull-left" src="../images/cv4/data-training4.png" alt="orig-depth" style="width: 378px; height: 324px; margin-bottom: .5em">
					</div>
				  </div>          
	          </div>
	        </aside>
          </div>
	    </article>
      </div>
    </article>
    <h3 class="depth-maps" style="border-left: 200px; padding: 1em;"><b>Depth Maps<b></h3>
      <div class="row">
        <div class="column">
	      <img class="hybrid img responsive pull-left" src="../images/cv3/mtns-matched.jpg" alt="depth-matched" style="width: 378px; height: 324px; margin-bottom: .5em"> 
	    </div>
	    <div class="column">
	      <img class="hybrid img responsive pull-left" src="../images/cv3/mtns-stereo.jpg" alt="orig-stereo" style="width: 378px; height: 324px; margin-bottom: .5em">
        </div>
        <div class="column">
          <img class="hybrid img responsive pull-left" src="../images/cv3/mtns-disp.jpg" alt="orig-depth" style="width: 378px; height: 324px; margin-bottom: .5em">
        </div>
	  </div>
      
      <!--Add different sizes-->
      
  <!--footer class="desc" style="border-left: 50px; text-align: pull-left; padding: 1em;">
    <p>CSCI 4527 - Introduction to Computer Vision<br>
       Spring 2018<br>
       Dr. Robert Pless<br>
    </p>
  </footer-->

  <style>
    body{
      background-color:fefefe;
      color:black;
      text-align:pull-left;
    }
  </style>

</body>
  
  
</html>
